## 1. cache
캐시를 사용하는 경우는 자주 사용하지만 업데이트가 적을 때 사용한다.
DB를 사용하는 비용보다 redis를 사용하는 비용이 더 좋고, 빠르기 때문.

콘서트 서비스에서 캐시를 사용할만한 경우는 3가지이다.

# 콘서트 조회
로직: 콘서트를 조회했을 때 콘서트 정보는 업데이트 되거나 삭제되지않는 이상 바뀌지 않기 떄문에
처음조회시 DB에서 가져오고 가끔 update될 때 캐시를 업데이트해준다. 그리고 데이터가 삭제되면 캐시에서 삭제해버리는 로직을 사용했다.
![alt text](<스크린샷 2024-08-01 오후 10.06.08.png>)

처음 콘서트를 조회했을 때 

![alt text](<스크린샷 2024-08-01 오후 10.04.06.png>)
sql qurey문과 함께 나가는 것을 확인할 수 있다.

하지만 첫번째 조회시 cache에 값을 저장했고, 계속 hit를 하면서 query를 날리지 않는 것을 확인 할 수 있다.

![alt text](<스크린샷 2024-08-01 오후 10.05.13.png>)

아래 사진을 참고하면 redis에 잘 저장된 것을 확인할 수 있다.
![alt text](<스크린샷 2024-08-01 오후 10.05.25.png>)

![alt text](<스크린샷 2024-08-01 오후 10.06.03.png>)
이제 업데이트를 하면 CachePut이 되어있기 때문에 캐시를 업데이트한다.

![alt text](<스크린샷 2024-08-01 오후 10.05.58.png>)

아래를 보면 캐시도 업데이트가 된것을 볼 수 있다.
![alt text](<스크린샷 2024-08-01 오후 10.06.17.png>)

마지막으로 데이터를 삭제하면

![alt text](<스크린샷 2024-08-01 오후 10.06.27.png>)
삭제 쿼리가 나가게되고,
![alt text](<스크린샷 2024-08-01 오후 10.06.31.png>)

![alt text](<스크린샷 2024-08-01 오후 10.06.38.png>)
redis에 있는 캐시가 삭제되게 된다.

# 콘서트 옵션 조회

로직: 콘서트 옵션을 조회했을 때 콘서트 옵션 정보는 업데이트 되거나 삭제되지않는 이상 바뀌지 않기 떄문에
처음조회시 DB에서 가져오고 가끔 update될 때 캐시를 업데이트해준다. 그리고 데이터가 삭제되면 캐시에서 삭제해버리는 로직을 사용했다.

![alt text](<스크린샷 2024-08-01 오후 10.06.59.png>)
콘서트 옵션을 조회하게 되면

![alt text](<스크린샷 2024-08-01 오후 10.06.54.png>)
콘서트 옵션 조회 query가 나가게되고
캐시에 저장되게 된다.
![alt text](<스크린샷 2024-08-01 오후 10.34.03.png>)



두번째 부터는 
![alt text](<스크린샷 2024-08-01 오후 10.07.09.png>)
쿼리가 안나가고 redis에서 불러온다.

![alt text](<스크린샷 2024-08-01 오후 10.07.09-1.png>)

만약 update를 한다면
![alt text](<스크린샷 2024-08-01 오후 10.30.13.png>)
update query가 나가고
![alt text](<스크린샷 2024-08-01 오후 10.34.28.png>)


![alt text](<스크린샷 2024-08-01 오후 10.07.39 복사본.png>)
캐시가 업데이트 되게된다.

만약 삭제를 하게되면 
![alt text](<스크린샷 2024-08-01 오후 10.07.44.png>)

delete query가 나오게되고
![alt text](<스크린샷 2024-08-01 오후 10.07.51.png>)

![alt text](<스크린샷 2024-08-01 오후 10.08.15.png>)
캐시가 삭제되게 된다.


# 좌석예약 조회
하지만 좌석예약은 수시로 업데이트 되기 떄문에 캐시에 부적절 하다고 판단 되어 캐시 플로우에서 제외를 시켰다.